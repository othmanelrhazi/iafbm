<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js">// Grids
Ext.ns('iafbm.grid.common');

Ext.define('iafbm.grid.common.Formations', {
    extend: 'Ext.ia.grid.EditPanel',
    height: 120,
    toolbarButtons: ['add', 'delete'],
    bbar: null,
    newRecordValues: {},
    store: null,
    listeners: {},
    columns: [{
        header: &quot;Formation&quot;,
        dataIndex: 'formation_id',
        width: 100,
        xtype: 'ia-combocolumn',
        editor: {
            xtype: 'ia-combo',
            store: new iafbm.store.Formation(),
            valueField: 'id',
            displayField: 'abreviation',
            allowBlank: false
        }
    },{
        header: &quot;Lieu (Ville / Pays)&quot;,
        dataIndex: 'lieu_these',
        flex: 1,
        editor: {
            xtype: 'textfield'
        }
    },{
        header: 'Jour',
        dataIndex: '_date_these_jour',
        width: 40,
        xtype: 'ia-combocolumn',
        editor: {
            xtype: 'ia-combo',
            mode: 'local',
            store: new Ext.data.ArrayStore({
                fields: ['value', 'label'],
                data: Ext.ia.staticdata.Days
            }),
            valueField: 'value',
            displayField: 'label'
        }
    },{
        header: 'Mois',
        dataIndex: '_date_these_mois',
        width: 55,
        xtype: 'ia-combocolumn',
        editor: {
            xtype: 'ia-combo',
            store: new Ext.data.ArrayStore({
                fields: ['value', 'label'],
                data: Ext.ia.staticdata.Months
            }),
            valueField: 'value',
            displayField: 'label'
        }
    },{
        header: 'Année',
        dataIndex: '_date_these_annee',
        width: 55,
        xtype: 'ia-combocolumn',
        editor: {
            xtype: 'ia-combo',
            store: new Ext.data.ArrayStore({
                fields: ['value', 'label'],
                data: Ext.ia.staticdata.Years
            }),
            valueField: 'value',
            displayField: 'label'
        }
    },{
        header: &quot;Commentaire&quot;,
        dataIndex: 'commentaire',
        flex: 1,
        editor: {
            xtype: 'textfield'
        }
    }]
});

Ext.define('iafbm.grid.common.Adresses', {
    extend: 'Ext.ia.grid.EditPanel',
    height: 120,
    toolbarButtons: ['add', 'delete'],
    bbar: null,
    newRecordValues: {},
    store: null,
    columns: [{
        header: &quot;Type&quot;,
        dataIndex: 'adresse_adresse_type_id',
        width: 85,
        xtype: 'ia-combocolumn',
        editor: {
            xtype: 'ia-combo',
            store: new iafbm.store.AdresseType(),
            valueField: 'id',
            displayField: 'nom',
            allowBlank: false
        }
    },{
        header: &quot;Adresse&quot;,
        dataIndex: 'adresse_rue',
        flex: 1,
        renderer: function(value) {
            // Converts NL|CR into &lt;br/&gt; for field display
            var breakTag = '&lt;br/&gt;';
            value = (value + '').replace(/([^&gt;\r\n]?)(\r\n|\n\r|\r|\n)/g, '$1' + breakTag + '$2');
            return ['&lt;div style=&quot;white-space:normal&quot;&gt;', value, '&lt;/div&gt;'].join('');
        },
        editor: {
            //xtype: 'textfield',
            xtype: 'ia-textarea',
            grow: true,
            growMin: 22,
            growMax: 22,
            fixEditorHeight: function() {
                // FIXME: Not used, should be deleted after feature validation
                // Sets RowEditor panel height according textarea height
                var editorHeight = this.el.down('textarea').getHeight();
                this.up('panel').setHeight(editorHeight+20);
            },
            fireKey: function(event) {
                // Accepts ENTER as regular key
                if (event.getKey() == event.ENTER) event.stopPropagation();
                //this.fixEditorHeight();
            },
            //listeners: {focus: function() {
            //    this.fixEditorHeight();
            //}}
        }
    },{
        header: &quot;NPA&quot;,
        dataIndex: 'adresse_npa',
        width: 40,
        editor: {
            xtype: 'textfield',
            maskRe: /[0-9]/
        }
    },{
        header: &quot;Lieu&quot;,
        dataIndex: 'adresse_lieu',
        width: 100,
        editor: {
            xtype: 'textfield',
        }
    },{
        header: &quot;Pays&quot;,
        dataIndex: 'adresse_pays_id',
        width: 100,
        xtype: 'ia-combocolumn',
        editor: {
            xtype: 'ia-combo',
            store: new iafbm.store.Pays(),
            valueField: 'id',
            displayField: 'nom',
        }
    },{
        header: &quot;Par défaut&quot;,
        dataIndex: 'defaut',
        width: 65,
        xtype: 'ia-radiocolumn',
        editor: {
            xtype: 'checkboxfield',
            disabled: true
        }
    }]
});

Ext.define('iafbm.grid.common.Telephones', {
    extend: 'Ext.ia.grid.EditPanel',
    height: 120,
    toolbarButtons: ['add', 'delete'],
    bbar: null,
    newRecordValues: {},
    store: null,
    columns: [{
        header: &quot;Type&quot;,
        dataIndex: 'adresse_type_id',
        width: 100,
        xtype: 'ia-combocolumn',
        editor: {
            xtype: 'ia-combo',
            store: new iafbm.store.AdresseType(),
            valueField: 'id',
            displayField: 'nom',
            allowBlank: false
        }
    },{
        header: &quot;Indicatif pays&quot;,
        dataIndex: 'countrycode',
        xtype: 'templatecolumn',
        tpl: '&lt;tpl if=&quot;countrycode.length &amp;gt; 0&quot;&gt;+&lt;/tpl&gt;{countrycode}',
        width: 38,
        editor: {
            xtype: 'textfield',
            maxLength: 3,
            enforceMaxLength: true,
            maskRe: /[0-9]/,
            vtype: 'telcc',
            allowBlank: false
        }
    },{
        header: &quot;Téléphone&quot;,
        dataIndex: 'telephone',
        flex: 1,
        editor: {
            xtype: 'textfield',
            maskRe: /[0-9]/,
            allowBlank: false
        }
    },{
        header: &quot;Par défaut&quot;,
        dataIndex: 'defaut',
        width: 65,
        xtype: 'ia-radiocolumn',
        editor: {
            xtype: 'checkboxfield',
            disabled: true
        }
    }]
});

Ext.define('iafbm.grid.common.Emails', {
    extend: 'Ext.ia.grid.EditPanel',
    height: 120,
    toolbarButtons: ['add', 'delete'],
    bbar: null,
    newRecordValues: {},
    store: null,
    iaDisableFor: [],
    columns: [{
        header: &quot;Type&quot;,
        dataIndex: 'adresse_type_id',
        width: 100,
        xtype: 'ia-combocolumn',
        editor: {
            xtype: 'ia-combo',
            store: new iafbm.store.AdresseType(),
            valueField: 'id',
            displayField: 'nom',
            allowBlank: false
        }
    },{
        header: &quot;Email&quot;,
        dataIndex: 'email',
        flex: 1,
        editor: {
            xtype: 'textfield',
            allowBlank: false,
            vtype: 'email'
        }
    },{
        header: &quot;Par défaut&quot;,
        dataIndex: 'defaut',
        width: 65,
        xtype: 'ia-radiocolumn',
        editor: {
            xtype: 'checkbox',
            disabled: true
        }
    }]
});</pre>
</body>
</html>
